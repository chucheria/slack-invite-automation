doctype html
html
  head
    meta(http-equiv="Content-Type", content="text/html; charset=utf-8")
    meta(name="viewport", content="width=device-width, initial-scale=1")
    title #{__('TITLE', community)}
    link(href="css/style.css", rel="stylesheet", type="text/css")
    link(rel="stylesheet", href="https://use.fontawesome.com/releases/v5.1.0/css/all.css", integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt", crossorigin="anonymous")
    link(href="//fonts.googleapis.com/css?family=Lato:300,400,700,900,700italic|Open+Sans:700italic,400,600,300,700,800", rel="stylesheet", type="text/css")
  body
    #wrapper
      .main
        .header
          h1
            strong #{community}
          h2 #{__('HEADER', community)}
          div.contact 
            a(href="mailto:slack@rladies.org")
              i.far.fa-envelope.fa-2x(aria-hidden='true') 
        .content
          .information
            div.confirm
              label
                input(type='checkbox', name="coc")#coc
                | I have read and agree to the #[a(href="https://github.com/rladies/starter-kit/wiki/Code-of-Conduct", target='_blank') CoC]
              label
                input(type='checkbox', name="non-male")#non-male
                | I identify as a woman or gender minority
            form(method="POST", action="/invite", autocomplete="off")#join-form.form
              input(type="email", name="email", autofocus, placeholder="#{__('ENTER_EMAIL')}")#slack-email.field
              if tokenRequired
                input(type="text", name="token", placeholder="#{__('ENTER_TOKEN')}")#slack-token.field
              input(type="submit", value="Join").submit
              if !!recaptchaSiteKey
                div(class="g-recaptcha", data-sitekey="#{recaptchaSiteKey}")
        .footer
            img.logo-img(src="images/community.png" alt="Community logo")
            img.logo-img(src="images/logo.png" alt="R-Ladies logo")
    if !!recaptchaSiteKey
       script(src='https://www.google.com/recaptcha/api.js')
    script.
      var tokenRequired = #{tokenRequired};
      var form = document.getElementById('join-form');
      var email = document.getElementById('slack-email');
      var token = document.getElementById('slack-token');
      var coc = document.getElementById('coc');
      var nonMale = document.getElementById('non-male');
      
      form.style.opacity = 0;
      coc.onclick = checkVisibility;
      nonMale.onclick = checkVisibility;
      
      form.addEventListener('submit', function(evt) {
        if (!email.value) {
          evt.preventDefault();
        }
        if (tokenRequired && !token.value) {
          evt.preventDefault();
        }
        var recaptcha = document.getElementById('g-recaptcha-response');
        if (recaptcha && recaptcha.value === '') {
          evt.preventDefault();
        }
      });
      
      function checkVisibility() {
          if (coc.checked && nonMale.checked) {
              form.style.opacity = 1;
          } else {
              form.style.opacity = 0;
          }
      }
